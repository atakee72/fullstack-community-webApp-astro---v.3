---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;
const { title, description, pubDate, author, tags, cover, coverAlt } = post.data;

const formattedDate = pubDate.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric'
});
---

<article class="bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 group">
  <a href={`/blog/${post.id}`} class="block">
    {cover ? (
      <div class="relative h-48 overflow-hidden">
        <Image
          src={cover}
          alt={coverAlt || title}
          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
          widths={[400, 600]}
          sizes="(max-width: 768px) 100vw, 400px"
        />
      </div>
    ) : (
      <div class="h-48 bg-gradient-to-br from-[#4b9aaa] to-[#3a7a8a] flex items-center justify-center">
        <svg class="w-16 h-16 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
        </svg>
      </div>
    )}
  </a>

  <div class="p-5">
    <div class="flex items-center gap-2 text-sm text-gray-500 mb-3">
      <time datetime={pubDate.toISOString()}>{formattedDate}</time>
      <span>â€¢</span>
      <span>{author}</span>
    </div>

    <a href={`/blog/${post.id}`} class="block group">
      <h2 class="text-xl font-bold text-gray-900 mb-2 group-hover:text-[#4b9aaa] transition-colors line-clamp-2">
        {title}
      </h2>
    </a>

    <p class="text-gray-600 mb-4 line-clamp-3">{description}</p>

    {tags && tags.length > 0 && (
      <div class="flex flex-wrap gap-2">
        {tags.slice(0, 3).map((tag) => (
          <a
            href={`/blog/tag/${tag}`}
            class="px-2 py-1 bg-[#4b9aaa]/10 text-[#4b9aaa] rounded-full text-xs font-medium hover:bg-[#4b9aaa]/20 transition-colors"
          >
            {tag}
          </a>
        ))}
        {tags.length > 3 && (
          <span class="px-2 py-1 text-gray-400 text-xs">+{tags.length - 3} more</span>
        )}
      </div>
    )}
  </div>
</article>
